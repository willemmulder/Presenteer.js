function Presenteer(canvas,elements,options){function outerScrollWidth(a,b){if($.browser.mozilla||$.browser.opera){var c=$(a).get(0).scrollWidth;var d=$(a).get(0).style.overflow;$(a).get(0).style.overflow="scroll"}var e=$(a).get(0).scrollWidth;if($.browser.mozilla||$.browser.opera){if(c>e){e=c}$(a).get(0).style.overflow=d}e+=$(a).outerWidth(b)-$(a).innerWidth();return e}function outerScrollHeight(a,b){if($.browser.mozilla||$.browser.opera){var c=$(a).get(0).scrollHeight;var d=$(a).get(0).style.overflow;$(a).get(0).style.overflow="scroll"}var e=$(a).get(0).scrollHeight;if($.browser.mozilla||$.browser.opera){if(c>e){e=c}$(a).get(0).style.overflow=d}e=e+($(a).outerHeight(b)-$(a).innerHeight());return e}function processElementTransforms(elm){var matrix="";for(var prefixID in prefixes){var prefix=prefixes[prefixID];if($(elm).css(prefix+"transform")!=null&&$(elm).css(prefix+"transform").indexOf("matrix")===0){var matrix=$(elm).css(prefix+"transform");break}}if(matrix!=""){var sylvesterMatrixString=matrix.replace(/matrix\((.+)\, (.+)\, (.+)\, (.+)\, (.+?)p?x?\, (.+?)p?x?\)/,"$M([[$1,$3,$5],[$2,$4,$6],[0,0,1]])");var sylvesterMatrix=eval(sylvesterMatrixString);var inverseMatrix=sylvesterMatrix.inverse();var inverseMatrixString="";if(inverseMatrix!=null){inverseMatrixString="matrix("+Math.round(inverseMatrix.e(1,1)*1e8)/1e8+", "+Math.round(inverseMatrix.e(2,1)*1e8)/1e8+", "+Math.round(inverseMatrix.e(1,2)*1e8)/1e8+", "+Math.round(inverseMatrix.e(2,2)*1e8)/1e8+", "+Math.round(inverseMatrix.e(1,3)*1e8)/1e8+", "+Math.round(inverseMatrix.e(2,3)*1e8)/1e8+""+")"}return inverseMatrixString}return""}function addTransformation(a,b){$(a).get(0).style.MozTransform+=b;$(a).get(0).style.WebkitTransform+=b;$(a).get(0).style.OTransform+=b;$(a).get(0).style.msTransform+=b;$(a).get(0).style.transform+=b}function setTransformation(a,b){for(var c in prefixes){var d=prefixes[c];$(a).css(d+"transform",b)}}function getTransformation(a){return $(a).get(0).style.WebkitTransform||$(a).get(0).style.MozTransform||$(a).get(0).style.OTransform||$(a).get(0).style.msTransform||$(a).get(0).style.transform||""}function setTransformOrigin(a,b,c){for(var d in prefixes){var e=prefixes[d];$(a).css(e+"transform-origin",b+" "+c)}}function setTransitions(a,b){var c=$(a);for(var d in prefixes){var e=prefixes[d];var f=b[d]||{};c.css(e+"transition-delay",f["transition-delay"]||"0s");c.css(e+"transition-duration",f["transition-duration"]||"0s");c.css(e+"transition-property",f["transition-property"]||"none");c.css(e+"transition-timing-function",f["transition-timing-function"]||"")}}function getTransitions(a){var b={};var c=$(a);for(var d in prefixes){var e=prefixes[d];var f=b[d]={};f["transition-delay"]=c.css(e+"transition-delay");f["transition-duration"]=c.css(e+"transition-duration");f["transition-property"]=c.css(e+"transition-property");f["transition-timing-function"]=c.css(e+"transition-timing-function")}return b}function show2(a){var b=$(a.element);var c=getTransitions(canvas);setTransitions(canvas,{});var d=getTransitions(b);setTransitions(b,{});var e=getTransformation(canvas);setTransformation(canvas,"");var f=getTransformation(b);setTransformation(b,"");var g=b.offset().left-canvas.offset().left;var h=b.offset().top-canvas.offset().top;var i=g*1+b.outerWidth()/2+"px";var j=h*1+b.outerHeight()/2+"px";setTransformation(b,f);setTransformation(canvas,e);setTransitions(canvas,c);setTransitions(a,c);setTransformOrigin(canvas,i,j);var k=processElementTransforms(b);var l=" translate("+g*-1+"px,"+h*-1+"px) "+k;setTransformation(canvas,l)}function show(a){var b=$(a.element);var c=getTransitions(canvas);setTransitions(canvas,{});var d=getTransitions(b);setTransitions(b,{});var e=getTransformation(canvas);setTransformation(canvas,"none");var f=getTransformation(b);setTransformation(b,"none");canvasZoomFactor=1;var g=b.offset().left-canvas.offset().left;var h=b.offset().top-canvas.offset().top;var i=canvas.outerWidth(options.showOriginalMargins);var j=canvas.outerHeight(options.showOriginalMargins);var k=canvas.parent().outerWidth();var l=canvas.parent().outerHeight();var m=b.outerWidth(options.showOriginalMargins)/k;var n=b.outerHeight(options.showOriginalMargins)/l;var o=Math.max(m,n);canvasZoomFactor=1/o;var p=(g-b.outerWidth(options.showOriginalMargins)*(canvasZoomFactor-1)/2)*-1;var q=(h-b.outerHeight(options.showOriginalMargins)*(canvasZoomFactor-1)/2)*-1;if(m>n){if(options.centerVertically){var r=l-b.outerHeight(options.showOriginalMargins)*canvasZoomFactor;q+=r/2}}else{if(options.centerHorizontally){var r=k-b.outerWidth(options.showOriginalMargins)*canvasZoomFactor;p+=r/2}}if(options.centerVertically&&outerScrollHeight(canvas,options.showOriginalMargins)*canvasZoomFactor<l){if(!$.browser.webkit){q=(l-outerScrollHeight(canvas,options.showOriginalMargins)*canvasZoomFactor)/2}}if(options.centerHorizontally&&outerScrollWidth(canvas,options.showOriginalMargins)*canvasZoomFactor<k){p=(k-outerScrollWidth(canvas,options.showOriginalMargins)*canvasZoomFactor)/2}var s=g*1+b.outerWidth()/2+"px";var t=h*1+b.outerHeight()/2+"px";setTransformation(canvas,e);setTransformation(b,f);setTimeout(function(){setTransitions(canvas,c);setTransitions(b,d);setTransformOrigin(canvas,s,t);var a=options.followElementTransforms?processElementTransforms(b):"";var e=" translate("+p+"px,"+q+"px)  scale("+canvasZoomFactor+") "+a;setTransformation(canvas,e)},1)}var canvas=$(canvas);if(canvas.size()==0){return false}setTransformOrigin(canvas,0,0);var canvasZoomFactor=1;var originalElements=elements;var elements=[];$.each(originalElements,function(a,b){if(b.nodeType==1){elements.push({element:$(b)})}else if(typeof b=="string"){elements.push({element:$(b)})}else{elements.push(b)}});var currentIndex=-1;var optionDefaults={showOriginalMargins:false,centerHorizontally:true,centerVertically:true,followElementTransforms:true,onBeforeEnter:function(a){},onAfterEnter:function(a){},onBeforeLeave:function(a){},onAfterLeave:function(a){}};if(typeof options!="object"){options={}}for(index in optionDefaults){if(typeof options[index]=="undefined"){options[index]=optionDefaults[index]}}var prefixes={moz:"-moz-",webkit:"-webkit-",o:"-o-",ms:"-ms-",all:""};return{start:function(){currentIndex=0;this.showCurrent()},restart:function(){currentIndex=0;this.showCurrent()},show:function(a){currentIndex=a;this.showCurrent()},next:function(){var a=currentIndex;currentIndex++;if(currentIndex>elements.length-1){currentIndex=0}if(elements[a]&&typeof elements[a].onBeforeLeaveToNext=="function"){elements[a].onBeforeLeaveToNext()}if(typeof elements[currentIndex].onBeforeEnterFromPrev=="function"){elements[currentIndex].onBeforeEnterFromPrev()}if(typeof elements[a].onBeforeLeave=="function"){elements[a].onBeforeLeave()}options.onBeforeLeave(elements[a]);this.showCurrent();if(elements[a]&&typeof elements[a].onAfterLeaveToNext=="function"){elements[a].onAfterLeaveToNext()}if(typeof elements[currentIndex].onAfterEnterFromPrev=="function"){elements[currentIndex].onAfterEnterFromPrev()}if(typeof elements[a].onAfterLeave=="function"){elements[a].onAfterLeave()}options.onBeforeLeave(elements[a])},prev:function(){var a=currentIndex;currentIndex--;if(currentIndex<0){currentIndex=elements.length-1}if(typeof elements[a].onBeforeLeaveToPrev=="function"){elements[a].onBeforeLeaveToPrev()}if(typeof elements[currentIndex].onBeforeEnterFromNext=="function"){elements[currentIndex].onBeforeEnterFromNext()}if(typeof elements[a].onBeforeLeave=="function"){elements[a].onBeforeLeave()}options.onBeforeLeave(elements[a]);this.showCurrent();if(typeof elements[a].onAfterLeaveToPrev=="function"){elements[a].onAfterLeaveToPrev()}if(typeof elements[currentIndex].onAfterEnterFromNext=="function"){elements[currentIndex].onAfterEnterFromNext()}if(typeof elements[a].onAfterLeave=="function"){elements[a].onAfterLeave()}options.onAfterLeave(elements[a])},previous:function(){this.prev()},showCurrent:function(){if(typeof elements[currentIndex].onBeforeEnter=="function"){elements[currentIndex].onBeforeEnter()}options.onBeforeEnter(elements[currentIndex]);show(elements[currentIndex]);if(typeof elements[currentIndex].onAfterEnter=="function"){elements[currentIndex].onAfterEnter()}options.onAfterEnter(elements[currentIndex])},getCanvas:function(){return $(canvas)}}}